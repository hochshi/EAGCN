import matplotlib; matplotlib.use('agg')
from skbio import DistanceMatrix
import numpy as np
data = np.load('experiment_result/server/small_batch_test/[\'all_tasks\']/May_02_09:14N_outputs.npz')
fps = data['fps']
fp_labels = data['fp_labels']
fps_cat = np.concatenate(fps)
labels_cat = np.concatenate(fp_labels)
labels_sort = np.argsort(labels_cat)
fps_sort = fps_cat[labels_sort]
from scipy.spatial.distance import pdist, squareform

dist_mat = pdist(fps_sort, 'euclidean')
dist_mat = squareform(dist_mat)
dm = DistanceMatrix(dist_mat)
grouping = labels_cat[labels_sort]
from skbio.stats.distance import anosim
anosim(dm, grouping, permutations=99)
